#
# Tests using a repo path >512 chars.
#
# This test should pass on any platform.
#

# Fossil will write data on $HOME, running 'fossil new' here.
# We need not to clutter the $HOME of the test caller.
#
set env(HOME) [pwd]

# Create the repo
#
set x [string repeat x 240]
set longpath [pwd]/$x/$x
file mkdir [pwd]/$x
file mkdir $longpath

test longpath-test.1 {
  ![regexp CANTOPEN [fossil new $longpath/$x.fossil]]
}

catch {file delete $longpath/$x.fossil}
catch {file delete [pwd]/$x/$x.fossil}
catch {file delete [pwd]/$x}

